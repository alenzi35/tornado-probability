<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>RAP LCC Test Render</title>
<style>
  body { margin:0; }
  canvas { display:block; width:100vw; height:100vh; background:#111; }
</style>
</head>
<body>
<canvas id="mapCanvas"></canvas>
<script>
const canvas = document.getElementById('mapCanvas');
const ctx = canvas.getContext('2d');

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

fetch('map/data/tornado_prob_lcc.json')
  .then(res => res.json())
  .then(data => {
    const features = data.features;
    console.log("First 5 points:", features.slice(0,5));

    // Compute bounds
    let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
    features.forEach(f => {
      if(f.x < minX) minX = f.x;
      if(f.x > maxX) maxX = f.x;
      if(f.y < minY) minY = f.y;
      if(f.y > maxY) maxY = f.y;
    });

    // Draw first 50 points for visibility
    for(let i=0; i<50; i++) {
      const f = features[i];
      const px = ((f.x - minX) / (maxX - minX)) * canvas.width;
      const py = canvas.height - ((f.y - minY) / (maxY - minY)) * canvas.height;

      const radius = 8; // increase to make points visible
      const red = Math.floor(255 * f.prob);
      const blue = Math.floor(255 * (1 - f.prob));
      ctx.fillStyle = `rgba(${red},0,${blue},0.8)`;
      ctx.beginPath();
      ctx.arc(px, py, radius, 0, Math.PI*2);
      ctx.fill();
    }
  })
  .catch(err => console.error(err));
</script>
</body>
</html>
