<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tornado Probability (LCC)</title>

  <script src="https://d3js.org/d3.v7.min.js"></script>

  <style>
    body {
      margin: 0;
      background: #0b0b0b;
      color: white;
      font-family: Arial, sans-serif;
    }

    svg {
      display: block;
      margin: auto;
      background: #111;
    }

    .border {
      fill: none;
      stroke: white;
      stroke-width: 1;
      opacity: 0.8;
    }

    .cell {
      stroke: none;
    }
  </style>
</head>

<body>

<svg id="map" width="1200" height="900"></svg>

<script>

const width = 1200;
const height = 900;

const svg = d3.select("#map");


// ================================
// Projection (Matches RAP LCC)
// ================================

const projection = d3.geoConicConformal()
  .parallels([50, 50])
  .rotate([-253, 0])
  .center([0, 50])
  .scale(900)
  .translate([width / 2, height / 2]);

const path = d3.geoPath().projection(projection);


// ================================
// Load Borders
// ================================

fetch("map/data/borders_lcc.json")
  .then(r => r.json())
  .then(borders => {

    console.log("Borders loaded");

    svg.append("g")
      .selectAll("path")
      .data(borders.features)
      .enter()
      .append("path")
      .attr("class", "border")
      .attr("d", path);

  })
  .catch(err => {
    console.error("Border load error:", err);
  });


// ================================
// Example: Test Chicago Cell
// ================================
// (For debugging alignment)

const chicago = {
  lat: 41.8781,
  lon: -87.6298
};

const projected = projection([chicago.lon, chicago.lat]);

if (projected) {

  svg.append("circle")
    .attr("cx", projected[0])
    .attr("cy", projected[1])
    .attr("r", 6)
    .attr("fill", "red");

  console.log("Chicago projected:", projected);

} else {
  console.error("Projection failed for Chicago");
}


</script>

</body>
</html>
